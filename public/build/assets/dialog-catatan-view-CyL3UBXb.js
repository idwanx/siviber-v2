import{r,j as e}from"./app-D1IlTu5u.js";import{a as T,b as w,c as D,d as _,e as C}from"./dialog-CK_31N3x.js";import{B as S}from"./button-fzuUEfQN.js";import{d as I,b as B,T as d,c as m,e as E,a as i}from"./table-Bh3tShep.js";import{C as H}from"./checkbox-CZ0JVWrU.js";import{S as A}from"./spinner-CeRrIVJd.js";import{c as R}from"./index-yNKx5cU1.js";import{A as L,a as F,b as U,u as K}from"./use-initials-D8AitkTo.js";/* empty css            */import"./index-DX1InUT_.js";import"./createLucideIcon-Civqs_1f.js";import"./index-DqkVbXcP.js";import"./Combination-BpchLQkK.js";import"./index-DTje7vMj.js";import"./index-6hOU0tmx.js";import"./index-Coqme9oQ.js";import"./index-DKIbkDSZ.js";import"./check-DHQvooRX.js";import"./loader-circle-Deq-QEXK.js";import"./index-DW9AIAM8.js";function ie({dialogOpen:h,dataValue:a}){const u=K(),[c,l]=r.useState([]),[j,x]=r.useState(!1),[f,p]=r.useState(!1),n=r.useRef(null),g=r.useCallback(async s=>{x(!0);try{const o=await(await fetch(R.index(s).url)).json();l(o),x(!1)}catch(t){throw x(!1),t}},[]),b=({itemCatatan:s})=>e.jsx(H,{id:s.id,checked:s.is_okey_new===void 0?s.is_okey:s.is_okey_new,onCheckedChange:void 0}),k=s=>{l([...c,{id:s.id,berka_id:s.berka_id,catatan:s.catatan,created_at:s.created_at,foto:s.foto,name:s.name,is_okey:s.is_okey,user_id:s.user_id}]),p(!0)},v=s=>{l(t=>t.map(o=>o.id===s.id?{...o,catatan:s.catatan,created_at:s.created_at}:o))},N=s=>{l(c.filter(t=>t.id!==s))};r.useEffect(()=>(h&&g(a.berka_id),()=>{}),[h]),r.useEffect(()=>{if(a)switch(a.action){case"addcatatan":k(a);break;case"updatecatatan":v(a);break;case"destroycatatan":N(a.id);break;default:return()=>{}}else return()=>{};return()=>{}},[a]),r.useEffect(()=>{f&&y()},[f]);const y=()=>{n.current&&(n.current.scrollTop=n.current.scrollHeight),p(!1)};return e.jsx(e.Fragment,{children:e.jsxs(T,{className:"p-0 sm:max-w-3xl 2xl:max-w-4xl top-0 mt-6 translate-y-0",onInteractOutside:s=>{s.preventDefault()},children:[e.jsxs(w,{className:"px-6 pt-4",children:[e.jsx(D,{className:"text-lg font-semibold text-foreground",children:"Daftar Catatan"}),e.jsx(_,{})]}),e.jsxs("div",{className:"grid grid-cols-8 text-sm text-muted-foreground px-6",children:[e.jsx("div",{children:"Kegiatan"}),e.jsxs("div",{className:"col-span-7",children:[": ",a?.kegiatan]}),e.jsx("div",{children:"No. Spm"}),e.jsxs("div",{className:"col-span-7",children:[": ",a?.no_spm]})]}),e.jsx("div",{ref:n,className:"xl:max-h-120 max-h-80 overflow-y-auto mx-4 border rounded-md",children:e.jsxs(I,{children:[e.jsx(B,{children:e.jsxs(d,{children:[e.jsx(m,{className:"w-7"}),e.jsx(m,{children:"Catatan"}),e.jsx(m,{className:"w-64",children:"Verifikator"})]})}),e.jsx(E,{children:j?e.jsx(d,{children:e.jsx(i,{colSpan:4,children:e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(A,{}),"Loading..."]})})}):c.length>0?c.map((s,t)=>e.jsxs(d,{children:[e.jsx(i,{children:e.jsx(b,{itemCatatan:s})}),e.jsx(i,{className:"whitespace-normal",children:s.catatan}),e.jsx(i,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(L,{className:"h-9 w-9 overflow-hidden rounded-full",children:s.foto?e.jsx(F,{src:`/storage/${s.foto}`,alt:s.name}):e.jsx(U,{className:"rounded-lg bg-neutral-200 text-black dark:bg-neutral-700 dark:text-white",children:u(s.name)})}),e.jsx("div",{className:"text-sm font-medium text-foreground",children:s.name})]},t)})]},t)):e.jsx(d,{children:e.jsx(i,{colSpan:3,children:"Tidak catatan."})})})]})}),e.jsx("div",{className:"flex border-t bg-muted rounded-b-md px-4 py-4",children:e.jsx("div",{className:"ml-auto",children:e.jsx(C,{asChild:!0,children:e.jsx(S,{variant:"outline",tabIndex:1,children:"Tutup"})})})})]})})}export{ie as default};
